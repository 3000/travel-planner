!function(){angular.module("rails",["ng"])}(),function(){angular.module("rails").factory("RailsInflector",function(){function t(t){return angular.isString(t)?t.replace(/_[\w\d]/g,function(t,e,r){return 0===e?t:r.charAt(e+1).toUpperCase()}):t}function e(t){return angular.isString(t)?t.replace(/[A-Z]/g,function(t,e){return 0===e?t:"_"+t.toLowerCase()}):t}function r(t){return t+"s"}return{camelize:t,underscore:e,pluralize:r}})}(),function(t){angular.module("rails").factory("RailsResourceInjector",["$injector",function(e){function r(r){return r?angular.isString(r)?e.get(r):r:t}function n(n){return n?e.instantiate(r(n)):t}function i(e){return angular.isObject(e)?e:e?n(e):t}return{createService:n,getService:i,getDependency:r}}])}(),function(){angular.module("rails").factory("railsUrlBuilder",["$interpolate",function(t){return function(e){var r;return angular.isFunction(e)||angular.isUndefined(e)?e:(-1===e.indexOf(t.startSymbol())&&(e=e+"/"+t.startSymbol()+"id"+t.endSymbol()),r=t(e),function(t){return e=r(t),"/"===e.charAt(e.length-1)&&(e=e.substr(0,e.length-1)),e})}}])}(),function(t){angular.module("rails").provider("railsSerializer",function(){var e={underscore:t,camelize:t,pluralize:t,exclusionMatchers:[]};this.underscore=function(t){return e.underscore=t,this},this.camelize=function(t){return e.camelize=t,this},this.pluralize=function(t){return e.pluralize=t,this},this.exclusionMatchers=function(t){return e.exclusionMatchers=t,this},this.$get=["$injector","RailsInflector","RailsResourceInjector",function(r,n,i){function s(r,n){function s(){angular.isFunction(r)&&(n=r,r={}),this.exclusions={},this.inclusions={},this.serializeMappings={},this.deserializeMappings={},this.customSerializedAttributes={},this.preservedAttributes={},this.customSerializers={},this.nestedResources={},this.options=angular.extend({excludeByDefault:!1},e,r||{}),n&&n.call(this,this)}return s.prototype.exclude=function(){var t=this.exclusions;return angular.forEach(arguments,function(e){t[e]=!1}),this},s.prototype.only=function(){var t=this.inclusions;return this.options.excludeByDefault=!0,angular.forEach(arguments,function(e){t[e]=!0}),this},s.prototype.nestedAttribute=function(){var t=this;return angular.forEach(arguments,function(e){t.rename(e,e+"_attributes")}),this},s.prototype.resource=function(t,e,r){return this.nestedResources[t]=e,r&&this.serializeWith(t,r),this},s.prototype.rename=function(e,r,n){return this.serializeMappings[e]=r,(n||n===t)&&(this.deserializeMappings[r]=e),this},s.prototype.add=function(t,e){return this.customSerializedAttributes[t]=e,this},s.prototype.preserve=function(t){return this.preservedAttributes[t]=!0,this},s.prototype.serializeWith=function(t,e){return this.customSerializers[t]=e,this},s.prototype.isExcludedFromSerialization=function(e){if(this.options.excludeByDefault&&!this.inclusions.hasOwnProperty(e)||this.exclusions.hasOwnProperty(e))return!0;if(this.options.exclusionMatchers){var r=!1;return angular.forEach(this.options.exclusionMatchers,function(n){angular.isString(n)?r=r||0===e.indexOf(n):angular.isFunction(n)?r=r||n.call(t,e):n instanceof RegExp&&(r=r||n.test(e))}),r}return!1},s.prototype.getSerializedAttributeName=function(e){var r=this.serializeMappings[e]||e,n=this.isExcludedFromSerialization(r),i=this.isExcludedFromSerialization(e);if(this.options.excludeByDefault){if(n&&i)return t}else if(n||i)return t;return this.underscore(r)},s.prototype.isExcludedFromDeserialization=function(){return!1},s.prototype.getDeserializedAttributeName=function(e){var r=this.camelize(e);return r=this.deserializeMappings[e]||this.deserializeMappings[r]||r,this.isExcludedFromDeserialization(e)||this.isExcludedFromDeserialization(r)?t:r},s.prototype.getNestedResource=function(t){return i.getDependency(this.nestedResources[t])},s.prototype.getAttributeSerializer=function(e){var r=this.getNestedResource(e),n=this.customSerializers[e];return n?i.createService(n):r?r.config.serializer:t},s.prototype.serializeValue=function(t){var e=t,r=this;if(angular.isArray(t))e=[],angular.forEach(t,function(t){e.push(r.serializeValue(t))});else if(angular.isObject(t)){if(angular.isDate(t))return t;e={},angular.forEach(t,function(t,n){angular.isFunction(t)||r.serializeAttribute(e,n,t)})}return e},s.prototype.serializeAttribute=function(e,r,n){var i=this.getAttributeSerializer(r),s=this.getSerializedAttributeName(r);s!==t&&(e[s]=i?i.serialize(n):this.serializeValue(n))},s.prototype.serialize=function(t){var e=this.serializeValue(t),r=this;return angular.isObject(e)&&angular.forEach(this.customSerializedAttributes,function(n,i){angular.isFunction(n)&&(n=n.call(t,t)),r.serializeAttribute(e,i,n)}),e},s.prototype.deserializeValue=function(t,e){var r=t,n=this;if(angular.isArray(t))r=[],angular.forEach(t,function(t){r.push(n.deserializeValue(t,e))});else if(angular.isObject(t)){if(angular.isDate(t))return t;r={},e&&(r=new e.config.resourceConstructor),angular.forEach(t,function(t,e){n.deserializeAttribute(r,e,t)})}return r},s.prototype.deserializeAttribute=function(e,r,n){var i,s,o=this.getDeserializedAttributeName(r);o!==t&&(i=this.getAttributeSerializer(o),s=this.getNestedResource(o),e[o]=this.preservedAttributes[o]?n:i?i.deserialize(n,s):this.deserializeValue(n,s))},s.prototype.deserialize=function(t,e){return this.deserializeValue(t,e)},s.prototype.pluralize=function(t){return this.options.pluralize?this.options.pluralize(t):t},s.prototype.underscore=function(t){return this.options.underscore?this.options.underscore(t):t},s.prototype.camelize=function(t){return this.options.camelize?this.options.camelize(t):t},s}return e.underscore=e.underscore||n.underscore,e.camelize=e.camelize||n.camelize,e.pluralize=e.pluralize||n.pluralize,s.defaultOptions=e,s}]})}(),function(t){angular.module("rails").factory("railsRootWrapper",function(){return{wrap:function(t,e){var r={};return r[angular.isArray(t)?e.config.pluralName:e.config.name]=t,r},unwrap:function(t,e){return t.data&&t.data.hasOwnProperty(e.config.name)?t.data=t.data[e.config.name]:t.data&&t.data.hasOwnProperty(e.config.pluralName)&&(t.data=t.data[e.config.pluralName]),t}}}),angular.module("rails").provider("RailsResource",function(){var e={rootWrapping:!0,updateMethod:"put",httpConfig:{},defaultParams:t,underscoreParams:!0,fullResponse:!1,extensions:[]};this.rootWrapping=function(t){return e.rootWrapping=t,this},this.updateMethod=function(t){return e.updateMethod=t,this},this.httpConfig=function(t){return e.httpConfig=t,this},this.defaultParams=function(t){return e.defaultParams=t,this},this.underscoreParams=function(t){return e.underscoreParams=t,this},this.fullResponse=function(t){return e.fullResponse=t,this},this.extensions=function(){return e.extensions=[],angular.forEach(arguments,function(t){e.extensions=e.extensions.concat(t)}),this},this.$get=["$http","$q","railsUrlBuilder","railsSerializer","railsRootWrapper","RailsResourceInjector",function(t,r,n,i,s,o){function u(t){if(t){var e=this.constructor.deserialize({data:t});this.constructor.config.rootWrapping&&(e=s.unwrap(e,this.constructor)),angular.extend(this,e.data)}}function a(t,e){return e&&("/"!==e[0]&&(t+="/"),t+=e),t}function c(t,e){for(var r,n=0,i=t.length;i>n;n++)r=t[n],angular.isString(r)&&(r=t[n]=o.getDependency(r)),e(r)}function l(t,e,r,n){var i=["included","extended,","configure"];t.$mixins||(t.$mixins=[]),angular.isString(r)&&(r=o.getDependency(r)),r&&-1===t.$mixins.indexOf(r)&&(angular.forEach(r,function(t,r){-1===i.indexOf(r)&&(e[r]=t)}),t.$mixins.push(r),angular.isFunction(n)&&n(t,r))}function f(t){var e=[];return angular.forEach(t,function(t){t="RailsResource"+t.charAt(0).toUpperCase()+t.slice(1)+"Mixin",e.push(o.getDependency(t))}),e}function p(t,e){return angular.isUndefined(t)?e:t}function h(t,e,r){return function(n){return(t||angular.identity)(n,e,r)}}function g(t,e,n){return function(i){return t?t(i,e,n):r.reject(i)}}return u.extendTo=function(t){function e(){this.constructor=t}return angular.forEach(this,function(e,r){t[r]=e}),angular.isArray(this.$modules)&&(t.$modules=this.$modules.slice(0)),e.prototype=this.prototype,t.prototype=new e,t.__super__=this.prototype,t},u.extend=function(){return angular.forEach(arguments,function(t){l(this,this,t,function(t,e){angular.isFunction(e.extended)&&e.extended(t)})},this),this},u.include=function(){return angular.forEach(arguments,function(t){l(this,this.prototype,t,function(t,e){angular.isFunction(e.included)&&e.included(t)})},this),this},u.configure=function(t){t=t||{},this.config&&(t=angular.extend({},this.config,t)),this.config={},this.config.url=t.url,this.config.rootWrapping=p(t.rootWrapping,e.rootWrapping),this.config.httpConfig=t.httpConfig||e.httpConfig,this.config.httpConfig.headers=angular.extend({Accept:"application/json","Content-Type":"application/json"},this.config.httpConfig.headers||{}),this.config.defaultParams=t.defaultParams||e.defaultParams,this.config.underscoreParams=p(t.underscoreParams,e.underscoreParams),this.config.updateMethod=(t.updateMethod||e.updateMethod).toLowerCase(),this.config.fullResponse=p(t.fullResponse,e.fullResponse),this.config.requestTransformers=t.requestTransformers?t.requestTransformers.slice(0):[],this.config.responseInterceptors=t.responseInterceptors?t.responseInterceptors.slice(0):[],this.config.afterResponseInterceptors=t.afterResponseInterceptors?t.afterResponseInterceptors.slice(0):[],this.config.interceptors=t.interceptors?t.interceptors.slice(0):[],this.config.serializer=o.getService(t.serializer||i()),this.config.name=this.config.serializer.underscore(t.name),this.config.name&&(this.config.pluralName=this.config.serializer.underscore(t.pluralName||this.config.serializer.pluralize(this.config.name))),this.config.urlBuilder=n(this.config.url),this.config.resourceConstructor=this,this.extend.apply(this,f((t.extensions||[]).concat(e.extensions))),angular.forEach(this.$mixins,function(e){angular.isFunction(e.configure)&&e.configure(this.config,t)},this)},u.setUrl=function(t){this.configure({url:t})},u.buildUrl=function(t){return this.config.urlBuilder(t)},u.addInterceptor=function(t){this.config.interceptors.push(t)},u.intercept=function(t,e){var r={};e=o.getDependency(e),r[t]=function(t,r,n){return e(t,r,n)||t},this.addInterceptor(r)},u.interceptBeforeRequest=function(t){this.intercept("beforeRequest",t)},u.interceptBeforeRequestWrapping=function(t){this.intercept("beforeRequestWrapping",t)},u.interceptRequest=function(t){this.intercept("request",t)},u.interceptBeforeResponse=function(t){this.intercept("beforeResponse",t)},u.interceptBeforeResponseDeserialize=function(t){this.intercept("beforeResponseDeserialize",t)},u.interceptResponse=function(t){this.intercept("response",t)},u.interceptAfterResponse=function(t){this.intercept("afterResponse",t)},u.beforeResponse=function(t){t=o.getDependency(t),this.interceptResponse(function(e,r,n){return t(e.data,r.config.resourceConstructor,n),e})},u.afterResponse=function(t){t=o.getDependency(t),this.interceptAfterResponse(function(e,r,n){return t(e,r.config.resourceConstructor,n),e})},u.beforeRequest=function(t){t=o.getDependency(t),this.interceptBeforeRequestWrapping(function(e,r){return e.data=t(e.data,r.config.resourceConstructor)||e.data,e})},u.serialize=function(t){return t.data&&(t.data=this.config.serializer.serialize(t.data)),t},u.deserialize=function(t){return t.data=this.config.serializer.deserialize(t.data,this.config.resourceConstructor),t},u.callResponseInterceptors=function(t,e){var r=this.config;return c(r.responseInterceptors,function(n){t.resource=r.resourceConstructor,t.context=e,t=n(t)}),t},u.callAfterResponseInterceptors=function(t){var e=this.config;return c(e.afterResponseInterceptors,function(r){t.resource=e.resourceConstructor,t=r(t)}),t},u.runInterceptorPhase=function(t,e,r){var n=this.config,i=[];for(c(n.interceptors,function(e){(e[t]||e[t+"Error"])&&i.push(e[t],e[t+"Error"])});i.length;){var s=i.shift(),o=i.shift();r=r.then(h(s,n.resourceConstructor,e),g(o,n.resourceConstructor,e))}return r},u.$http=function(e,n,i){var o=angular.extend(angular.copy(this.config),i||{}),u=o.resourceConstructor,a=r.when(e);return a=this.runInterceptorPhase("beforeRequest",n,a).then(function(t){return t=u.serialize(t),c(o.requestTransformers,function(e){t.data=e(t.data,o.resourceConstructor)}),t}),a=this.runInterceptorPhase("beforeRequestWrapping",n,a),o.rootWrapping&&(a=a.then(function(t){return t.data=s.wrap(t.data,o.resourceConstructor),t})),a=this.runInterceptorPhase("request",n,a).then(function(e){return t(e)}),a=this.runInterceptorPhase("beforeResponse",n,a),a=this.runInterceptorPhase("beforeResponse",n,a).then(function(t){return t.originalData=t.data,t}),o.rootWrapping&&(a=a.then(function(t){return s.unwrap(t,o.resourceConstructor)})),a=this.runInterceptorPhase("beforeResponseDeserialize",n,a).then(function(t){return u.deserialize(t)}),a=this.callResponseInterceptors(a,n),a=this.runInterceptorPhase("response",n,a).then(function(t){return n&&t.hasOwnProperty("data")&&angular.isObject(t.data)&&angular.extend(n,t.data),o.fullResponse?t:n||t.data}),a=this.callAfterResponseInterceptors(a,n),a=this.runInterceptorPhase("afterResponse",n,a),a.resource=o.resourceConstructor,a.context=n,a},u.processParameters=function(t){var e={};return angular.isObject(t)&&this.config.underscoreParams?(angular.forEach(t,function(t,r){e[this.config.serializer.underscore(r)]=t},this),e):t},u.getParameters=function(t){var e;return this.config.defaultParams&&(e=angular.copy(this.config.defaultParams)),angular.isObject(t)&&(e=angular.extend(e||{},t)),this.processParameters(e)},u.getHttpConfig=function(t){var e=this.getParameters(t);return e?angular.extend({params:e},this.config.httpConfig):angular.copy(this.config.httpConfig)},u.$url=u.resourceUrl=function(t,e){return angular.isObject(t)||(t={id:t}),a(this.buildUrl(t||{}),e)},u.$get=function(t,e){return this.$http(angular.extend({method:"get",url:t},this.getHttpConfig(e)))},u.query=function(t,e){return this.$get(this.resourceUrl(e),t)},u.get=function(t,e){return this.$get(this.resourceUrl(t),e)},u.prototype.$url=function(t){return a(this.constructor.resourceUrl(this),t)},u.prototype.$http=function(t,e){return this.constructor.$http(t,this,e)},angular.forEach(["post","put","patch"],function(t){u["$"+t]=function(e,r){return r=angular.copy(r),this.$http(angular.extend({method:t,url:e,data:r},this.getHttpConfig()))},u.prototype["$"+t]=function(e){var r=angular.copy(this,{});return this.constructor.$http(angular.extend({method:t,url:e,data:r},this.constructor.getHttpConfig()),this)}}),u.prototype.create=function(){return this.$post(this.$url(),this)},u.prototype.update=function(){return this["$"+this.constructor.config.updateMethod](this.$url(),this)},u.prototype.isNew=function(){return angular.isUndefined(this.id)||null===this.id},u.prototype.save=function(){return this.isNew()?this.create():this.update()},u.$delete=function(t,e){return this.$http(angular.extend({method:"delete",url:t},this.getHttpConfig(e)))},u.prototype.$delete=function(t,e){return this.constructor.$http(angular.extend({method:"delete",url:t},this.constructor.getHttpConfig(e)),this)},u.prototype.remove=u.prototype["delete"]=function(){return this.$delete(this.$url())},u}]}),angular.module("rails").factory("railsResourceFactory",["RailsResource",function(t){return function(e){function r(){r.__super__.constructor.apply(this,arguments)}return t.extendTo(r),r.configure(e),r}}])}();