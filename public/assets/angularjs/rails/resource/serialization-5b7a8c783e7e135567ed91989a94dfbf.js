!function(e){angular.module("rails").provider("railsSerializer",function(){var i={underscore:e,camelize:e,pluralize:e,exclusionMatchers:[]};this.underscore=function(e){return i.underscore=e,this},this.camelize=function(e){return i.camelize=e,this},this.pluralize=function(e){return i.pluralize=e,this},this.exclusionMatchers=function(e){return i.exclusionMatchers=e,this},this.$get=["$injector","RailsInflector","RailsResourceInjector",function(t,r,s){function n(t,r){function n(){angular.isFunction(t)&&(r=t,t={}),this.exclusions={},this.inclusions={},this.serializeMappings={},this.deserializeMappings={},this.customSerializedAttributes={},this.preservedAttributes={},this.customSerializers={},this.nestedResources={},this.options=angular.extend({excludeByDefault:!1},i,t||{}),r&&r.call(this,this)}return n.prototype.exclude=function(){var e=this.exclusions;return angular.forEach(arguments,function(i){e[i]=!1}),this},n.prototype.only=function(){var e=this.inclusions;return this.options.excludeByDefault=!0,angular.forEach(arguments,function(i){e[i]=!0}),this},n.prototype.nestedAttribute=function(){var e=this;return angular.forEach(arguments,function(i){e.rename(i,i+"_attributes")}),this},n.prototype.resource=function(e,i,t){return this.nestedResources[e]=i,t&&this.serializeWith(e,t),this},n.prototype.rename=function(i,t,r){return this.serializeMappings[i]=t,(r||r===e)&&(this.deserializeMappings[t]=i),this},n.prototype.add=function(e,i){return this.customSerializedAttributes[e]=i,this},n.prototype.preserve=function(e){return this.preservedAttributes[e]=!0,this},n.prototype.serializeWith=function(e,i){return this.customSerializers[e]=i,this},n.prototype.isExcludedFromSerialization=function(i){if(this.options.excludeByDefault&&!this.inclusions.hasOwnProperty(i)||this.exclusions.hasOwnProperty(i))return!0;if(this.options.exclusionMatchers){var t=!1;return angular.forEach(this.options.exclusionMatchers,function(r){angular.isString(r)?t=t||0===i.indexOf(r):angular.isFunction(r)?t=t||r.call(e,i):r instanceof RegExp&&(t=t||r.test(i))}),t}return!1},n.prototype.getSerializedAttributeName=function(i){var t=this.serializeMappings[i]||i,r=this.isExcludedFromSerialization(t),s=this.isExcludedFromSerialization(i);if(this.options.excludeByDefault){if(r&&s)return e}else if(r||s)return e;return this.underscore(t)},n.prototype.isExcludedFromDeserialization=function(){return!1},n.prototype.getDeserializedAttributeName=function(i){var t=this.camelize(i);return t=this.deserializeMappings[i]||this.deserializeMappings[t]||t,this.isExcludedFromDeserialization(i)||this.isExcludedFromDeserialization(t)?e:t},n.prototype.getNestedResource=function(e){return s.getDependency(this.nestedResources[e])},n.prototype.getAttributeSerializer=function(i){var t=this.getNestedResource(i),r=this.customSerializers[i];return r?s.createService(r):t?t.config.serializer:e},n.prototype.serializeValue=function(e){var i=e,t=this;if(angular.isArray(e))i=[],angular.forEach(e,function(e){i.push(t.serializeValue(e))});else if(angular.isObject(e)){if(angular.isDate(e))return e;i={},angular.forEach(e,function(e,r){angular.isFunction(e)||t.serializeAttribute(i,r,e)})}return i},n.prototype.serializeAttribute=function(i,t,r){var s=this.getAttributeSerializer(t),n=this.getSerializedAttributeName(t);n!==e&&(i[n]=s?s.serialize(r):this.serializeValue(r))},n.prototype.serialize=function(e){var i=this.serializeValue(e),t=this;return angular.isObject(i)&&angular.forEach(this.customSerializedAttributes,function(r,s){angular.isFunction(r)&&(r=r.call(e,e)),t.serializeAttribute(i,s,r)}),i},n.prototype.deserializeValue=function(e,i){var t=e,r=this;if(angular.isArray(e))t=[],angular.forEach(e,function(e){t.push(r.deserializeValue(e,i))});else if(angular.isObject(e)){if(angular.isDate(e))return e;t={},i&&(t=new i.config.resourceConstructor),angular.forEach(e,function(e,i){r.deserializeAttribute(t,i,e)})}return t},n.prototype.deserializeAttribute=function(i,t,r){var s,n,u=this.getDeserializedAttributeName(t);u!==e&&(s=this.getAttributeSerializer(u),n=this.getNestedResource(u),i[u]=this.preservedAttributes[u]?r:s?s.deserialize(r,n):this.deserializeValue(r,n))},n.prototype.deserialize=function(e,i){return this.deserializeValue(e,i)},n.prototype.pluralize=function(e){return this.options.pluralize?this.options.pluralize(e):e},n.prototype.underscore=function(e){return this.options.underscore?this.options.underscore(e):e},n.prototype.camelize=function(e){return this.options.camelize?this.options.camelize(e):e},n}return i.underscore=i.underscore||r.underscore,i.camelize=i.camelize||r.camelize,i.pluralize=i.pluralize||r.pluralize,n.defaultOptions=i,n}]})}();