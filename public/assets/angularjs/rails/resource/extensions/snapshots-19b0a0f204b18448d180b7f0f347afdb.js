!function(){angular.module("rails").factory("RailsResourceSnapshotsMixin",["RailsResourceInjector",function(s){function t(){}function n(s){var t=this.constructor.config,n=(t.snapshotSerializer||t.serializer).serialize(this);return delete n.$snapshots,n.$rollbackCallback=s,this.$snapshots||(this.$snapshots=[]),this.$snapshots.push(n),this.$snapshots.length-1}function a(s){var t,n,a=this.constructor.config,i=this.$snapshots,r=this.$snapshots?this.$snapshots.length:0;return angular.isArray(i)&&0!==r&&angular.isNumber(s)?(t=i.splice(Math.max(0,Math.min(s,r-1))),angular.isArray(t)&&0!==t.length?(n=t[0].$rollbackCallback,angular.extend(this,(a.snapshotSerializer||a.serializer).deserialize(t[0])),this.$snapshots=i,delete this.$rollbackCallback,angular.isFunction(n)&&n.call(this),!0):!1):!1}function i(s){var t=this.$snapshots?this.$snapshots.length:0;return s=Math.min(s||1,t),0>s&&(s=t),t&&this.rollbackTo(this.$snapshots.length-s),!0}return t.configure=function(t,n){t.snapshotSerializer=s.getService(n.snapshotSerializer)},t.extended=function(s){s.intercept("afterResponse",function(s,t,n){n&&n.hasOwnProperty("$snapshots")&&angular.isArray(n.$snapshots)&&(n.$snapshots.length=0)}),s.include({snapshot:n,rollback:i,rollbackTo:a})},t}])}();