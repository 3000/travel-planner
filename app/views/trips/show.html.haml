- content_for :title, @trip.name

.row.trip-header
  .col-md-3.col-sm-3
    .fileupload-form{'ng-mouseleave' => 'mouse_over_image = false',
         'ng-mouseenter' => 'mouse_over_image = true'}
      - if @user_can_edit
        = form_for @trip, url: upload_photo_trip_path(@trip), method: :post, multipart: true, remote: true do |f|
          = f.hidden_field :remove_image, value: 'true'
          = link_to '', class: 'delete-trip-image-button delete-image', 'ng-show' => 'mouse_over_image',
              'data-confirm' => t('.delete_photo_cofirm') do
            = fa_icon 'times'

        = form_for @trip, url: upload_photo_trip_path(@trip), method: :post, multipart: true do |f|
          = f.file_field :image, class: 'fileupload'
          = link_to 'javascript:void(0)', class: 'upload-trip-image-button upload-link',
            'ng-show' => 'mouse_over_image' do
            = fa_icon 'upload'

      %img{class: 'img-thumbnail', id: 'trip_image',
        src: @trip.image_url_or_default,
        width: '100%'}

    .progress-wrapper
      .progress
        .progress-bar{role: "progressbar"}

    .photo-processing
      %i.fa.fa-spinner.fa-spin
      = t('common.photo_processing')

  .col-md-9.col-sm-9
    - if user_signed_in?
      .btn-toolbar.pull-right
        = link_to "#{new_trip_path}?copy_from=#{@trip.id}", target: '_blank', class: 'btn btn-info',
          'data-tooltip' => t('trips.show.clone') do
          = fa_icon 'copy'

        - if @user_can_edit
          = link_to edit_trip_path(@trip), class: 'btn btn-success',
            'data-tooltip' => t('trips.show.edit_trip') do
            = fa_icon 'pencil'

          - if @trip.author_user_id == current_user.id
            = link_to trip_path(@trip), class: 'btn btn-danger', method: :delete,
              'data-confirm'=> t('common.delete_confirm'), 'data-tooltip' => t('trips.show.delete_trip') do
              = fa_icon 'times'

    %h3
      = @trip.name
      %small
        = l @trip.start_date, format: :month

    %p.travel-text{} #{@trip.short_description}

    .well.well-sm.trip-status{class: trip_status_class(@trip.status_code)}
      %big
        = t('.status_code')
        = @trip.status_text
        - if @trip.private
          (#{t('activerecord.attributes.travels/trip.private')})

    %h4
      = t('.travellers')
    = render'trips/partials/participants', participants: @trip.users

%hr

- if params[:tab] == ApplicationHelper::TAB_REPORT
  = render 'trips/tabs/report'

- content_for :additional_content do
  - if params[:tab].blank? || params[:tab] == ApplicationHelper::TAB_PLAN
    = render 'trips/tabs/plan'

